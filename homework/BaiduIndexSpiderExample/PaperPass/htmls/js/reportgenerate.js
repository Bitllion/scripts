var TypeOf=typeof isHasDetailReport;if(TypeOf=="boolean"&&isHasDetailReport==true){FirstGenerateReport();var RefactorData=PaperPagination();RefactorHtml(RefactorData)}else{FirstProofGenerateReport();var RefactorData=PaperPagination();var finalArry=setArry(RefactorData);RefactorHtml(finalArry)}function FirstGenerateReport(){var e=0;var s="";$.each(detailJsonData,function(n,{content:a,sectionCount:t,score:o}){if(t!=e){e=t;s+='<div class="section_edit"><span class="section_num">'+t+'</span><span class="interval-line"></span><span class="icon iconfont icon-bianji"></span></div>'}var o=Math.round(o*100);if(a==="")return;if(typeof separateDetailJsonData!=="undefined"&&separateDetailJsonData[n]){$.each(separateDetailJsonData[n],function(t,a){let e=parseToHtml(n,o,a);s+=e})}else{let t=parseToHtml(n,o,a);s+=t}});var t='<div class="jcjymywwzd"><div class="upkmzjakmc"><div class="stl_view">'+s+"</div></div></div>";$("#mbxsgxktna").append(t)}function parseToHtml(t,a,e){var e=e.replace(/[<>\&]/g,function(t){return"&#"+t.charCodeAt(0)+";"});if(a<40){return"<span>"+e+"</span>"}else if(a<70){return'<a href="sentence_detail.html" target="right" data-id="'+t+'" data-score="'+a+'"><span class="orange">'+e+"</span></a>"}else{return'<a href="sentence_detail.html" target="right" data-id="'+t+'" data-score="'+a+'"><span class="red">'+e+"</span></a>"}}function FirstProofGenerateReport(){if(typeof separateProofJsonData!=="undefined"){var a=0;for(let t=0;t<proofJsonData.length;t++){if(!!proofJsonData[t+1]){if(proofJsonData[t].sentenceCount==proofJsonData[t+1].sentenceCount){proofJsonData[t].numCount=proofJsonData[t].sentenceCount+"-"+a;a++}else{proofJsonData[t].numCount=proofJsonData[t].sentenceCount+"-"+a;a=0}}else{proofJsonData[t].numCount=proofJsonData[t].sentenceCount+"-"+a}}for(var o in separateProofJsonData){var s=0;for(let n=0;n<proofJsonData.length;n++){if(proofJsonData[n].sentenceCount==o){let t="";if(proofJsonData[n].content.length<separateProofJsonData[o][s].length){let t=separateProofJsonData[o][s].substring(0,proofJsonData[n].content.length);let a=separateProofJsonData[o][s].substring(proofJsonData[n].content.length);let e=[t,a];proofJsonData[n+1].numCount=proofJsonData[n].numCount;separateProofJsonData[o].splice(s,1,...e)}else if(proofJsonData[n].content.length>separateProofJsonData[o][s].length){t=proofJsonData[n].content;proofJsonData[n].content=separateProofJsonData[o][s];proofJsonData.splice(n+1,0,{pid:proofJsonData[n].pid,content:t.substring(proofJsonData[n].content.length),sectionCount:proofJsonData[n].sectionCount,sentenceCount:proofJsonData[n].sentenceCount,maps:proofJsonData[n].maps,numCount:proofJsonData[n].numCount+n})}else if(proofJsonData[n].content.length==separateProofJsonData[o][s].length){t=""}if(!!proofJsonData[n+1]){if(proofJsonData[n+1].sentenceCount==proofJsonData[n].sentenceCount){s++}else{s=0}}}else{s=0}}}for(let t=0;t<proofJsonData.length;t++){if(proofJsonData[t].maps.length>0){if(!!proofJsonData[t-1]){proofJsonData[t].numCount==proofJsonData[t-1].numCount}}}proofJsonData.forEach(t=>{if(!separateProofJsonData[t.sentenceCount]){t.numCount=t.sentenceCount}})}let e=proofJsonData.reduce((t,a)=>{t[a.sectionCount]=t[a.sectionCount]?[...t[a.sectionCount],a]:[a];return t},{});var n=[];for(let t in e){n.push(e[t])}var r="";for(let t=0;t<n.length;t++){r+=`<div id = "tit_${t+1}" class="section_edit">${t+1}</div>`}var t=`<div class="jcjymywwzd"><div class="upkmzjakmc noFize"><div class="stl_view">${r}</div></div></div>`;$("#mbxsgxktna").append(t);n.forEach((t,a)=>{var o="";t.forEach((t,a)=>{var e=t.content.replace(/[<>\&]/g,function(t){return"&#"+t.charCodeAt(0)+";"});if(e==="")return;if(t.maps.length<1){o+=`<span class="spaceWrap" data-sentenceCount=${t.sentenceCount} data-child=${t.numCount?t.numCount:t.sentenceCount}>${e}</span>`}else if(t.maps.length==1){if(t.maps[0].type=="innerDuplicate"){o+=`<span id=${t.maps[0].id} data-sentenceCount=${t.sentenceCount} data-child=${t.numCount?t.numCount:t.sentenceCount}><a href="proof_right.html#${t.pid?t.pid:t.maps[0].id}" class="noletter" target="right"><span class="spaceWrap proof_type ${t.maps[0].type} orange">${e}</span></a></span>`}else if(t.maps[0].type=="political"){o+=`<span id=${t.maps[0].id} data-sentenceCount=${t.sentenceCount} data-child=${t.numCount?t.numCount:t.sentenceCount}><a href="proof_right.html#${t.maps[0].id}" class="noletter" target="right"><span class="spaceWrap proof_type ${t.maps[0].type} red">${e}</span></a></span>`}else{o+=`<a href="proof_right.html#${t.maps[0].id}" class="noletter" id="${t.maps[0].id}" target="right" data-sentenceCount=${t.sentenceCount} data-child=${t.numCount?t.numCount:t.sentenceCount}><span class="spaceWrap proof_type ${t.maps[0].type}">${e}</span></a>`}}else if(t.maps.length==2){var n="";t.maps.forEach(t=>{if(t.type=="innerDuplicate"){n="orange"}else if(t.type=="political"){n="red"}});o+=`<span id=${t.maps[0].id} data-sentenceCount=${t.sentenceCount} data-child=${t.numCount?t.numCount:t.sentenceCount}><a href="proof_right.html#${t.maps[1].id}" class="noletter" id="${t.maps[1].id}" target="right"><span class="spaceWrap proof_type ${t.maps[0].type} ${t.maps[1].type} ${n}">${e}</span></a></span>`}});$(`#tit_${a+1}`).after(o)})}function setArry(a){var e=[];for(let t in a){e.push(a[t])}let n=[...e];for(let e=0;e<n.length;e++){var t;if(e+1<n.length){t=n[e][n[e].length-1].getAttribute("data-child");if(t){let a=n[e+1].map(t=>t.getAttribute("data-child")).lastIndexOf(t);if(a>-1){let t=n[e+1].splice(0,a+1);n[e].push(...t)}}continue}}return n}function PaperPagination(){var t=75,a=0,e=0;var n=[];var o=[];$.each($(".stl_view").children(),function(){a=$(this).offset().top;e=a-t;if(e>=960){n.push(o);o=[];t=$(this).offset().top}o.push(this)});n.push(o);return n}function RefactorHtml(t){$("#mbxsgxktna").html("");var n="";$.each(t,function(t,a){var e="";$.each(a,function(){e+=nodeToStr(this)});n+=`<div class="jcjymywwzd" id="${t+1}"><div class="upkmzjakmc"><div class="stl_view">${e}</div></div></div>`});$("#mbxsgxktna").append(n);$("#mbxsgxktna").append('<div id="Add_height" style="height:0;"></div>')}function nodeToStr(t){let a=document.createElement("div");a.appendChild(t.cloneNode(true));const e=a.innerHTML;a=t=null;return e}